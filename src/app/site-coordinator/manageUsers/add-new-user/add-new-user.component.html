<section class="subheader p-none pl-none">
  <div class="max__w__850 m-none">
    <div class="row">
      <div class="col-xs-12 col-md-12 pl-none">
        <a href="#" class="subheader__title">
          <!-- <img class="mr-sm" src="../../../../assets/images/left-arrow.gif" alt="Add new User"> -->
          <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path fill="#1a73e8" d="M20 11H6.83l2.88-2.88c.39-.39.39-1.02 0-1.41-.39-.39-1.02-.39-1.41 0L3.71 11.3c-.39.39-.39 1.02 0 1.41L8.3 17.3c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L6.83 13H20c.55 0 1-.45 1-1s-.45-1-1-1z"/></svg>
          <span class="ml-xs">Add New User</span>
        </a>
      </div>
    </div>
  </div>
</section>

<section class="max__w__850 add__location">
  <form #addUserForm="ngForm" autocomplete="off">
    <section class="bg__white card__inside__pad box__shadow-cmn m-none">
      <div class="row border-bottom__c4d1e6">
        <div class="col-xs-12 col-md-6 p-none border-right__c4d1e6">
          <div class="form-group ">
            <label for="fname">First Name</label>
            <input placeholder="Enter First Name" type="text" class="form-control" id="fname" minlength="3" maxlength="50" [(ngModel)]="user.firstName"
              name="firstName" #firstName="ngModel" required pattern="^[A-Za-z]{3,50}$">
              <div *ngIf="firstName.invalid && (firstName.dirty || firstName.touched)">
                <span class="help-block with-errors error__msg" *ngIf="firstName.errors.required">
                  First Name is required.
                </span>
                <span class="help-block with-errors error__msg" *ngIf="firstName.errors.pattern">
                  Please enter 3 alphabets with no space.
                </span>
              </div>
          </div>
        </div>
        <div class="col-xs-12 col-md-6 p-none">
          <div class="form-group ">
            <label for="app">Last Name</label>
            <input type="text" minlength="2" maxlength="50" [(ngModel)]="user.lastName" name="lastName"
              #lastName="ngModel" required pattern="^[A-Za-z]{2,50}$" class="form-control" id="lname"
              placeholder="Enter Last Name">
         
          <div *ngIf="lastName.invalid && (lastName.dirty || lastName.touched)">
            <span class="help-block with-errors error__msg" *ngIf="lastName.errors.required">
              Last Name is required.
            </span>
            <span class="help-block with-errors error__msg" *ngIf="lastName.errors.pattern">
              Please enter 2 alphabets with no space.
            </span>
          </div>
        </div>
        </div>
      </div>
      <div class="row">
        <div class="col-xs-12 col-md-12 p-none">
          <div class="form-group">
            <label for="emailId">Email ID</label>
            <input type="email" class="form-control" id="emailId" placeholder="Enter Email" [(ngModel)]="user.email"
              name="emailText"
              pattern='(("[\w-\s]+")|([\w-]+(?:\.[\w-]+)*)|("[\w-\s]+")([\w-]+(?:\.[\w-]+)*))(@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][0-9]\.|1[0-9]{2}\.|[0-9]{1,2}\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\]?$)'
              #emailText="ngModel" required>
         
          <div *ngIf="emailText.invalid && (emailText.dirty || emailText.touched)">
            <span class="help-block with-errors error__msg" *ngIf="emailText.errors.required">
              Email is required.
            </span>
            <span class="help-block with-errors error__msg" *ngIf="emailText.errors.pattern">
              Email is invalid.
            </span>
          </div>
        </div>
        </div>
      </div>
    </section>

    <h2 class="subheader__title mb-sm">Permissions</h2>

    <section class="bg__white card__inside__pad box__shadow-cmn m-none">
      <div class="row">
        <div class="col-xs-12 col-md-6 p-none border-right__c4d1e6">
          <div class="form-group">
            <div class="custom__labels">
              <input type="checkbox" id="Users" [(ngModel)]="user.superAdmin" name="superAdminCheckBox"
                #superAdminCheckBox="ngModel">
              <label for="Users">Super Admin</label>
            </div>

          </div>
        </div>
        <div class="col-xs-12 col-md-6 p-none">
          <div class="form-group ">
            <div class="custom__labels">
              <input type="checkbox" id="pe" [(ngModel)]="user.manageLocationsCheckBox" name="manageLocationsCheckBox"
                #manageLocationsCheckBox="ngModel">
              <label for="pe">Locations</label>
            </div>
            <div class="pl-xl pt-xs">
              <span>
                <input type="radio" id="test3" name="radio-group2" [(ngModel)]="user.manageLocationsPermission"
                  name="manageLocationsPermission" #manageLocationsPermission="ngModel">
                <label for="test3">View</label>
              </span>
              <span>
                <input type="radio" id="test4" name="radio-group2" [(ngModel)]="user.manageLocationsPermission"
                  name="manageLocationsPermission" #manageLocationsPermission="ngModel">
                <label for="test4">View And Edit</label>
              </span>
            </div>
          </div>
        </div>
      </div>
    </section>
    <section class="bg__white card__inside__pad box__shadow-cmn m-none">
      <div class="form-group">
        <div class="text__353a3e__16 pb-lg"> Sites, Studies and Apps</div>
        <div class="select__form-control__parent">
          <label class="wrap">Select and Add App
            <ng-select [items]="apps" [clearable]="false" [multiple]="true" bindLabel="name" (add)="itemChanged()"
              class="form-control select__form-control" placeholder="Enter App ID or Name" [hideSelected]="true"
              [(ngModel)]="selectedApps" [ngModelOptions]="{standalone: true}">
            </ng-select>
          </label>
        </div>
      </div>

      <!-- <div class="form-group pt-none">
        <div class="accordion" id="accordionExample">
          <div class="card">
            <div class="flex__justify__space-between">
              <div class="acc__dele">
                <div class="card-header">
                  <div class="mb-0 flex__justify__space-between">
                    <div class="">
                      <div class="custom__labels">
                        <input type="checkbox" id="Users1">
                        <label for="Users1">Health Studies App <span
                            class="text__353a3e__11 ml-xs">(APP001)</span></label>
                      </div>
                    </div>
                    <div class=" fa__plus__minus" (click)="collapseEvent()" type="button" data-toggle="collapse"
                      data-target="#collapseOne" aria-expanded="false"></div>
                  </div>
                </div>
                <div id="collapseOne" class="collapse" data-parent="#accordionExample">
                  <div class="card-body">
                    <div class="card-body__pad">
                      <div class="custom__labels">
                        <input type="checkbox" id="Users1">
                        <label for="Users1">Health Studies App <span
                            class="text__353a3e__11 ml-xs">(APP001)</span></label>
                      </div>
                      <div class="card-body__pad">
                        <span>
                          <input type="radio" id="test1" name="radio-group1">
                          <label for="test1">View</label>
                        </span>
                        <span>
                          <input type="radio" id="test2" name="radio-group1" checked>
                          <label for="test2">View And Edit</label>
                        </span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div><img src="../../../../assets/images/delete-icon.gif"  (click)="deleteAppFromList(1)" alt="delete"></div>
            </div>
          </div>

          <div class="card">
            <div class="flex__justify__space-between">
              <div class="acc__dele">
                <div class="card-header">
                  <div class="mb-0 flex__justify__space-between">
                    <div class="">
                      <div class="custom__labels">
                        <input type="checkbox" id="Users2">
                        <label for="Users2">Better Tomoorow App <span
                            class="text__353a3e__11 ml-xs">(APP001)</span></label>
                      </div>
                      <div class="pl-xl pt-xs">
                        <span>
                          <input type="radio" id="test1" name="radio-group1">
                          <label for="test1">View</label>
                        </span>
                        <span>
                          <input type="radio" id="test2" name="radio-group1" checked>
                          <label for="test2">View And Edit</label>
                        </span>
                      </div>
                    </div>
                    <div class=" fa__plus__minus" type="button" data-toggle="collapse" data-target="#collapseTwo"
                      aria-expanded="false" ></div>
                  </div>
                </div>
                <div id="collapseTwo" class="collapse"  data-parent="#accordionExample">
                  <div class="card-body">
                    <div class="accordion sub__accordian card-body__pad" id="accordionExample1">

                      <div class="text__ffbc00__12 pb-sm">Total 2 Studies</div>

                      <div class="card">
                        <div class="card-header">
                          <div class="mb-0 flex__justify__space-between">
                            <div class="">
                              <div class="custom__labels">
                                <input type="checkbox" id="Users1">
                                <label for="Users1">A Study for Fitness </label>
                              </div>
                              <div class="custom__labels__radio">
                                <span>
                                  <input type="radio" id="test1" name="radio-group1">
                                  <label for="test1">View</label>
                                </span>
                                <span>
                                  <input type="radio" id="test2" name="radio-group1" checked>
                                  <label for="test2">View And Edit</label>
                                </span>
                              </div>
                            </div>
                            <div class=" fa__plus__minus" type="button" data-toggle="collapse"
                              data-target="#collapseTwo1" aria-expanded="false"></div>
                          </div>
                        </div>
                        <div id="collapseTwo1" class="collapse"
                          data-parent="#accordionExample1">
                          <div class="card-body">
                            <div class="text__ffbc00__12 pad__T10__B20">Total 2 Sites</div>
                            <div class="">
                              <div class="custom__labels">
                                <input type="checkbox" id="Users1">
                                <label for="Users1">A Study for Fitness </label>
                              </div>
                              <div class="custom__labels__radio">
                                <span>
                                  <input type="radio" id="test1" name="radio-group1">
                                  <label for="test1">View</label>
                                </span>
                                <span>
                                  <input type="radio" id="test2" name="radio-group1" checked>
                                  <label for="test2">View And Edit</label>
                                </span>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div><img src="../../../../assets/images/delete-icon.gif" alt="delete"></div>
            </div>
          </div>
        </div>
      </div>  -->


      <div class="form-group pt-none">
        <div class="accordion" id="accordionExample">
          <div *ngFor="let app of selectedApps" class="card">
            <div class="flex__justify__space-between">
              <div class="acc__dele">
                <div class="card-header">
                  <div class="mb-0 flex__justify__space-between">
                    <div class="">
                      <div class="custom__labels">
                        <input type="checkbox" id="appCheckBox{{app.id}}" [(ngModel)]="app.selected"
                          [ngModelOptions]="{standalone: true}" (change)="appCheckBoxChange($event,app)">
                        <label for="appCheckBox{{app.id}}">{{app.name}}<span
                            class="text__353a3e__11 ml-xs">({{app.customId}})</span></label>
                      </div>
                      <div class="pl-xl pt-xs">
                        <span>
                          <input type="radio" [value]="1" [(ngModel)]="app.permission" [disabled]="!app.selected"
                            [ngModelOptions]="{standalone: true}" id="appRadioView{{app.id}}"
                            name="appRadioGroup{{app.id}}" (change)="appRadioButtonChange($event,app)">
                          <label for="appRadioView{{app.id}}">View</label>
                        </span>
                        <span>
                          <input type="radio" [value]="2" [(ngModel)]="app.permission" [disabled]="!app.selected"
                            [ngModelOptions]="{standalone: true}" id="appRadioEdit{{app.id}}"
                            name="appRadioGroup{{app.id}}" (change)="appRadioButtonChange($event,app)">
                          <label for="appRadioEdit{{app.id}}">View And Edit</label>
                        </span>
                      </div>
                    </div>
                    <div class=" fa__plus__minus" type="button" data-toggle="collapse"
                      [attr.data-target]="'#collapse'+app.id" aria-expanded="false"></div>
                  </div>
                </div>
                <div id="collapse{{app.id}}" class="collapse" data-parent="#accordionExample">
                  <div class="card-body">
                    <div class="accordion sub__accordian card-body__pad" id="accordionExample{{app.id}}">

                      <div class="text__ffbc00__12 pb-sm">Total {{app.studies.length}} Studies</div>

                      <div class="card" *ngFor="let study of app.studies">
                        <div class="card-header">
                          <div class="mb-0 flex__justify__space-between">
                            <div class="">
                              <div class="custom__labels">
                                <input (change)="studyCheckBoxChange($event,study)" [disabled]="study.disabled"
                                  type="checkbox" id="studyCheckBox{{study.studyId}}" [(ngModel)]="study.selected"
                                  [ngModelOptions]="{standalone: true}">
                                <label for="studyCheckBox{{study.studyId}}">{{study.studyName}} </label>
                              </div>
                              <div class="custom__labels__radio">
                                <span>
                                  <input [disabled]="study.disabled || !study.selected" type="radio" [value]="1"
                                    [(ngModel)]="study.permission" [ngModelOptions]="{standalone: true}"
                                    id="studyRadioView{{study.studyId}}" name="studyRadioGroup{{study.studyId}}"
                                    (change)="studyRadioButtonChange($event,study)">
                                  <label for="studyRadioView{{study.studyId}}">View</label>
                                </span>
                                <span>
                                  <input [disabled]="study.disabled || !study.selected" type="radio" [value]="2"
                                    [(ngModel)]="study.permission" [ngModelOptions]="{standalone: true}"
                                    id="studyRadioEdit{{study.studyId}}" name="studyRadioGroup{{study.studyId}}"
                                    (change)="studyRadioButtonChange($event,study)">
                                  <label for="studyRadioEdit{{study.studyId}}">View And Edit</label>
                                </span>
                              </div>
                            </div>
                            <div class=" fa__plus__minus" type="button" data-toggle="collapse"
                              [attr.data-target]="'#collapseTwo'+study.studyId" aria-expanded="false"></div>
                          </div>
                        </div>
                        <div id="collapseTwo{{study.studyId}}" class="collapse"
                          [attr.data-parent]="'#accordionExample'+app.id">
                          <div class="card-body">
                            <div class="text__ffbc00__12 pad__T10__B20">Total {{study.sites.length}} Sites</div>
                            <div class="" *ngFor="let site of study.sites">
                              <div class="custom__labels">
                                <input (change)="siteCheckBoxChange($event,site)" [disabled]="site.disabled"
                                  type="checkbox" id="siteCheckBox{{site.siteId}}" [ngModelOptions]="{standalone: true}"
                                  [(ngModel)]="site.selected">
                                <label for="siteCheckBox{{site.siteId}}">{{site.locationName}} </label>
                              </div>
                              <div class="custom__labels__radio">
                                <span>
                                  <input [disabled]="site.disabled || !site.selected" type="radio" [value]="1"
                                    [(ngModel)]="site.permission" [ngModelOptions]="{standalone: true}"
                                    id="siteRadioRead{{site.siteId}}" name="siteRadioGroup{{site.siteId}}">
                                  <label for="siteRadioRead{{site.siteId}}">View</label>
                                </span>
                                <span>
                                  <input [disabled]="site.disabled || !site.selected" type="radio" [value]="2"
                                    [(ngModel)]="site.permission" [ngModelOptions]="{standalone: true}"
                                    id="siteRadioEdit{{site.siteId}}" name="siteRadioGroup{{site.siteId}}">
                                  <label for="siteRadioEdit{{site.siteId}}">View And Edit</label>
                                </span>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 0 24 24" width="20"><path d="M0 0h24v24H0V0z" fill="none"/><path fill="#a7b5cc" d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v10zM18 4h-2.5l-.71-.71c-.18-.18-.44-.29-.7-.29H9.91c-.26 0-.52.11-.7.29L8.5 4H6c-.55 0-1 .45-1 1s.45 1 1 1h12c.55 0 1-.45 1-1s-.45-1-1-1z"/></svg></div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="btn__container">
      <button type="submit" class="btn  bt__add bt__add__auto mr-sm">Create User and Invite</button>
      <button type="button" class="btn bt__cancel" (click)="modalRef.hide()">Cancel</button>
    </section>
  </form>
</section>
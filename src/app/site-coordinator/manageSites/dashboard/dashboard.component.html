<div class="min__height__100">
  <ul class="subheader subheader__menu nav nav-tabs ">
    <li [ngClass]="{'active':activeTab=='sites'}"><a (click)="changeTab('sites')" data-toggle="tab">Sites</a></li>
    <li [ngClass]="{'active':activeTab=='studies'}"><a (click)="changeTab('studies')" data-toggle="tab">Studies</a></li>
    <li [ngClass]="{'active':activeTab=='apps'}"><a (click)="changeTab('apps')" data-toggle="tab">Apps</a>
    </li>
  </ul>
  <div class="tab-content">
    <div *ngIf="activeTab=='sites'" class="site__content">
      <div *ngFor="let studyWithSite of studiesWithSites" class="bg__white cards  box__shadow-cmn">
        <div class="flex__ flex__row">
          <div class="img__container__left">
            <img class="" src="../../../assets/images/site-list-tab.gif" alt="A Study for Pregnant Women">
          </div>
          <div class="width__100">
            <div class=" row">
              <div class="col-xs-12  col-md-12 p-none text__353a3e__20">{{studyWithSite.customId}}</div>
              <div class="text__757b80__12 row flex-wrap-unset col-xs-12  col-md-12 p-none">
                <div class="col-xs-6 col-md-3  p-none"><span
                    *ngIf="studyWithSite.type!='OPEN'">{{studyWithSite.sites.length}}
                    sites</span><span *ngIf="studyWithSite.type=='OPEN'">Open Study</span></div>
                <div class=" col-xs-6 col-md-9 text-right p-none mb__display__none">Enrolled/<span
                    *ngIf="studyWithSite.type!='OPEN'">Invited</span><span
                    *ngIf="studyWithSite.type=='OPEN'">Target</span></div>
              </div>
              <div class="col-xs-12 col-md-12 p-none  border__bottom__red progress__bar">
                <div *ngFor="let site of studyWithSite.sites" class="row display-flex-center progress__bar__row">
                  <div class="col-xs-12 col-md-8 p-none">{{site.name}}</div>
                  <div class="col-xs-12 col-md-4 p-none lh__6">
                    <div class="prog">
                      <div class="pro__base">
                        <div *ngIf="site.invitedCount!=0">
                          <div class="pro__top" [style.width.%]="site.enrollmentPercentage"></div>
                        </div>
                      </div>
                    </div>
                    <div class="progress-label font__bold"
                      [ngClass]="(site.enrollmentPercentage<30)?'text__f85555__12':(site.enrollmentPercentage<70?'text__ffbc00__12':'text__63bb67__12')">
                      <div><span *ngIf="site.invitedCount!=0">{{site.enrolledCount}}/{{site.invitedCount}}</span><span
                          *ngIf="site.invitedCount==0">N/A</span></div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- <div class="clearfix"></div> -->
            </div>
            <div *ngIf="studyWithSite.type!='OPEN' && studyWithSite.studyPermission==2">
              <button class="bt__4285f4 add__site" (click)="openAddSiteModal(template,studyWithSite)">+ Add
                Site</button>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>
  <div *ngIf="activeTab=='studies'">
    <div *ngFor="let study of studies" class="bg__white cards cards__var box__shadow-cmn">
      <div class="flex__justify__space-between flex__wrap">
        <div class="">
          <div class="flex__ flex__row align__items__center ">
            <div class="img__container__left">
              <img class="" src="../../../assets/images/site-list-tab.gif" alt="A Study for Pregnant Women">
            </div>
            <div>
              <div class="text__4285f4__12 text-capitalize">{{study.customId}}</div>
              <div class="col-xs-12  col-md-12 p-none text__353a3e__20">{{study.name}}</div>
              <div class="text__757b80__12 row flex-wrap-unset col-xs-12  col-md-12 p-none">
                <div class="col-xs-6 col-md-12  p-none"><span *ngIf="study.type!='OPEN'">{{study.totalSitesCount}}
                    sites</span><span *ngIf="study.type=='OPEN'">Open Study</span></div>
              </div>
            </div>
          </div>
        </div>
        <div class="mb__width__100">
          <div class="flex__ flex__row align__items__center ">
            <div class=" mb__width__100">
              <div class="col-xs-12  p-none lh__6">
                <div class="prog">
                  <div *ngIf="study.invitedCount!=0" class="pro__base">
                    <div class="pro__top" [style.width.%]="study.enrollmentPercentage"></div>
                  </div>
                  <div class="progress-label font__bold"
                    [ngClass]="(study.enrollmentPercentage<30)?'text__f85555__12':(study.enrollmentPercentage<70?'text__ffbc00__12':'text__63bb67__12')">
                    <span *ngIf="study.invitedCount!=0">{{study.enrolledCount}}/{{study.invitedCount}}</span><span
                      *ngIf="study.invitedCount==0">N/A</span>
                  </div>
                </div>
              </div>
            </div>
            <div class="text-right progress__bar__next">
              <div class="text__b6c5db__50"> <span
                  *ngIf="study.invitedCount!=0">{{study.enrollmentPercentage| number : '.2-2' }}%</span><span
                  *ngIf="study.invitedCount==0">N/A</span></div>
              <div class="text__757b80__12"><span *ngIf="study.type!='OPEN'">Enrolled/Invited</span><span
                  *ngIf="study.type=='OPEN'">Enrolled/Target</span></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div *ngIf="activeTab=='apps'">
    <div *ngFor="let app of apps" class="bg__white cards  box__shadow-cmn   p-xl">
      <div class="flex__justify__space-between flex__wrap">
        <div class="">
          <div class="">
            <div class="text__4285f4__12 text-capitalize">{{app.customId}}</div>
            <div class="col-xs-12  col-md-12 p-none text__353a3e__20">{{app.name}}</div>
            <div class="text__757b80__12 row flex-wrap-unset col-xs-12  col-md-12 p-none">
              <div class="col-xs-6 col-md-12  p-none">{{app.totalStudiesCount}} Studies<span
                  *ngIf="app.appPermission!=0">, {{app.appUsersCount}}  App Users</span></div>
            </div>
          </div>
        </div>
        <div class="mb__width__100">
          <div class="flex__ flex__row align__items__center ">
            <div class=" mb__width__100">
              <div class="col-xs-12  p-none lh__6">
                <div class="prog">
                  <div class="pro__base">
                    <div class="pro__top" style="width:30%"></div>
                  </div>
                  <div class="progress-label font__bold"
                    [ngClass]="(app.enrollmentPercentage<30)?'text__f85555__12':(app.enrollmentPercentage<70?'text__ffbc00__12':'text__63bb67__12')">
                    <span *ngIf="app.invitedCount!=0">{{app.enrolledCount}}/{{app.invitedCount}}</span><span
                      *ngIf="app.invitedCount==0">N/A</span>
                  </div>
                </div>
              </div>
            </div>
            <div class="text-right progress__bar__next">
              <div class="text__b6c5db__50"> <span
                  *ngIf="app.invitedCount!=0">{{app.enrollmentPercentage| number : '.2-2' }}%</span><span
                  *ngIf="app.invitedCount==0">N/A</span></div>
              <div class="text__757b80__12">Enrolled/Invited</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- loader -->
<!-- <div class="text-center mb-lg">
  <img src="../../../assets/images/loader-dot.gif" alt="Lpading">
</div> -->
<!-- loader -->

<!-- modal -->
<ng-template #template>
  <div class="modal-body modal__body">

    <div class="row border__bottom__c4d1e6 background__dfe4ec">
      <div class="col-xs-12 col-md-5 p-none">
        <div class="form-group ">
          <label for="study">study</label>
          <div>{{addSite.studyCustomId}}</div>
        </div>
      </div>
      <div class="col-xs-12 col-md-7 p-none">
        <div class="form-group ">
          <label for="app">app</label>
          <div>{{addSite.appId}}</div>
        </div>
      </div>
    </div>
    <form #addSiteForm="ngForm" (ngSubmit)="addSite()" autocomplete="off">
      <div class="row border__bottom__c4d1e6">
        <div class="col-xs-12 col-md-12 p-none">
          <div class="form-group">
            <label for="Location">Location</label>
            <select class="form-control" [(ngModel)]="locationId" required name="locationId" #newSiteLocation="ngModel">
              <option value="Select Location">Select Location</option>
            </select>
          </div>
        </div>
      </div>

      <div class="p-xlg">
        <button type="submit" [disabled]="addSiteForm.form.invalid" class="btn bt__add mr-sm"
          (click)="addSite()">Add</button>
        <button type="button" class="btn bt__cancel" (click)="modalRef.hide()">Cancel</button>
      </div>
    </form>
  </div>
</ng-template>
<!-- modal -->

<!-- ************************************************************************************* -->